<!DOCTYPE html>
@{
    ViewBag.Title = "GeoQuiz";
}
<html>
<head>
    <title>Earth</title>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0">
    <script type="text/javascript"
            src="https://www.google.com/jsapi">
    </script>
</head>
<body>
    <div style="width: 100%; overflow: hidden;">
        <div style="height: 50px;"></div>
        <div style="width: 600px; float: left;">
            <div style="height: 300px;">
                <h1 class="text-success" align="center">Italija</h1>
            </div>
            <div style="margin-left: 50px;">
                <h2>Statistika</h2>
                <h4>Bodovi:</h4>
                <h4>Točni odgovori:</h4>
                <h4>Netočni odgovori:</h4>
                <h4>Neodgovorena pitanja:</h4>
            </div>
        </div>
        <div style="margin-left: 620px;">
            <div align="right" id="map3d"
                 style="height: 600px;
              width: 900px;">
                <h2>
                    <script type="text/javascript">
    var ge;
    google.load("earth", "1",{ "other_params": "sensor=false" });
    google.setOnLoadCallback(init);


    function init() {
        google.earth.createInstance('map3d', initCB, failureCB);

    }

    //inicijaliziranje
    function initCB(instance) {
        ge = instance;
        ge.getWindow().setVisibility(true);
        ge.getLayerRoot().enableLayerById(ge.LAYER_BORDERS , false);

        //loadanje KML-a
        var kmlUrl = 'https://sites.google.com/site/mislavsite/countries_world-kml/doc3.kml?attredirects=0&d=1';
        addKmlFromUrl(kmlUrl);

        function addKmlFromUrl(kmlUrl) {
            google.earth.fetchKml(ge, kmlUrl, kmlFinishedLoading);
        }

        function kmlFinishedLoading(kmlObject) {
            if (kmlObject) {
                ge.getFeatures().appendChild(kmlObject);
            }
        }

        function kmlFinishedLoading(kmlObject) {
            if (kmlObject) {
                // check if the object is a KmlContainer (folder or document)
                if ('getFeatures' in kmlObject) {
                    var firstChild = kmlObject.getFeatures().getFirstChild();
                    if (firstChild !== null) {
                        kmlObject.getFeatures().removeChild(firstChild);
                    }
                }

                ge.getFeatures().appendChild(kmlObject);
            }
        }

        //sprijecanje balona
        google.earth.addEventListener(ge.getGlobe(), 'click', popupPrevent); //sprijecavanje balona nakon klika

        function popupPrevent(event) {
            event.preventDefault();
        }

        //double-click oznacavanje konacnog odgovora (drzave)
        google.earth.addEventListener(ge.getGlobe(), 'dblclick', recordEvent);

        function recordEvent(event) {
            var target = event.getTarget();
            var type = target.getType();
            if (type == "KmlPlacemark") {
                // get the data you want from the target.
                var description = target.getDescription();
                var balloon = target.getBalloonHtml();
                var n = balloon.indexOf("=Niger'");  //gdje je Niger ići će varijabla trenutna država koju ćemo izgenerirati
                alert(n);
            }
        }



        


        //ge.getView().setAbstractView(kmlObject.getAbstractView());
        //setLookAt(ge, -122.448425, 37.802907,200000.0)
        //Australija
        //setLookAt(ge, -24.0, 130.0, 5500000.0);
        //Europa
        setLookAt(ge, 50.0, 20.0, 4500000.0);
        //Azija
        //setLookAt(ge, 40.0, 100.0, 8000000.0);
        //networkLink.setFlyToView(true);
    }
    function setLookAt(ge, latitude, longitude, range) {
        var lookAt = ge.createLookAt('');
        lookAt.setLatitude(latitude);
        lookAt.setLongitude(longitude);
        lookAt.setRange(range);
        ge.getView().setAbstractView(lookAt);
    }

    function failureCB(errorCode) {
    }
    google.setOnLoadCallback(init);
        </script>
    </h2>
</div>
<div class="navbar navbar-default" style="width: 900px;">
    <div class="container">
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li>@Html.ActionLink("Europa", "Index", "Home")</li>
                <li>@Html.ActionLink("Afrika", "Igraj", "Home")</li>
                <li>@Html.ActionLink("Azija", "Contact", "Home")</li>
                <li>@Html.ActionLink("S. Amerika", "Contact", "Home")</li>
                <li>@Html.ActionLink("J. Amerika", "Contact", "Home")</li>
                <li>@Html.ActionLink("Australija", "Contact", "Home")</li>
                <li>                                                                                 </li>
                <li>@Html.ActionLink("Nova igra", "Index", "Home")</li>
            </ul>
        </div>

    </div>
</div>
</div>
</div>
</body>
</html>